<html>
  <head>
    <title>Opening…</title>
  </head>
  <body>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
      contextClass = window.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext || window.msAudioContext;
      function get(name) {
        var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
        var r = window.location.search.substr(1).match(reg);
        if (r != null) {
          return unescape(r[2]);
        }
        return null;
      }
      var context = new contextClass();
      var source = null;
      var audioBuffer = null;
      function stopSound() {
        if (source) {
          source.stop(musics);
        }
      }
      function playSound() {
        source = context.createBufferSource();
        source.buffer = audioBuffer;
        source.loop = true;
        source.connect(context.destination);
        source.start(0);
      }
      function initSound(arrayBuffer) {
        context.decodeAudioData(arrayBuffer, function(buffer) {
          audioBuffer = buffer;
          playSound();
        }, function(e) {
          alert("Not found");
        });
      }
      function loadAudioFile(url) {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.responseType = 'arraybuffer';
        xhr.onload = function(e) {
          initSound(this.response);
          document.title = "播放中…";
        };
        xhr.send();
      }
      var music = get("source");
      loadAudioFile(music);
    </script>
  </body>
</html>
